> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [github.com](https://github.com/mansk1es/CVE-2024-21111)

CVE-2024-21111
==============

[](#cve-2024-21111)

Oracle VirtualBox Prior to 7.0.16 is vulnerable to Local Privilege Escalation via Symbolic Link Following leading to Arbitrary File Delete and Arbitrary File Move.

VirtualBox attempts to move log files as NT AUTHORITY\SYSTEM in C:\ProgramData\VirtualBox (which all users can write to) to backup themselves by an ordinal, but MAX 10 logs. VirtualBox will also try to delete the 11th log as NT AUTHORITY\SYSTEM exposing itself to 2 bugs that lead to privilege escalation. Finding this bug was very interesting :)

Arbitrary File Delete
---------------------

[](#arbitrary-file-delete)

VirtualBox_EoP_PoC_Del.mp4<video src="https://private-user-images.githubusercontent.com/74832816/324359603-54a78fa6-82b2-441a-8b37-ad411fbc6e33.mp4?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTQwMTMyNzcsIm5iZiI6MTcxNDAxMjk3NywicGF0aCI6Ii83NDgzMjgxNi8zMjQzNTk2MDMtNTRhNzhmYTYtODJiMi00NDFhLThiMzctYWQ0MTFmYmM2ZTMzLm1wND9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA0MjUlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNDI1VDAyNDI1N1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWNkYzUxZTc0MjFkYWE0MDNmYmY1NDEwYTAzYmQ3NjlmNmJlZjYzZjQ2OWE5MWExMmQxZDE5N2JiMzA5YWZjZGEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.Zio_mbMA_NVgHWV0yHpl7Hq47o274djZ3fDcRcQYOf8" control></video>

Arbitrary File Move
-------------------

[](#arbitrary-file-move)

VirtualBox_EoP_PoC_Move.mp4<video src="https://private-user-images.githubusercontent.com/74832816/324359665-85430839-bb51-4c8e-b6c4-9fd38b256ff8.mp4?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTQwMTMyNzcsIm5iZiI6MTcxNDAxMjk3NywicGF0aCI6Ii83NDgzMjgxNi8zMjQzNTk2NjUtODU0MzA4MzktYmI1MS00YzhlLWI2YzQtOWZkMzhiMjU2ZmY4Lm1wND9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA0MjUlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNDI1VDAyNDI1N1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPThjZWNlYzgzY2Y3MTFkNmMzYmM5MjA4NDhlNGEzZGRhYmI0YjZhMmU5NzQwNDdkNzJmNjg1ODYzNjk3YTBhYmEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.FaI7rCXn_1uXXn-e-5Gaa1ifmnuLRgq8G2M639ClpJQ" control></video>

Fun fact me and @filip_dragovic (Wh04m1001) found this bug each independently :D shout out to him!

### Report Timeline

[](#report-timeline)

*   19/3/2024 - Vulnerability Reported to Oracle
*   21/3/2024 - Oracle Confirms Vulnerability
*   13/4/2024 - Oracle Notified About Public Advisory
*   16/4/2024 - CVE-2024-21111 Publicized && Public Advisory on Oracle Critical Patch Updates